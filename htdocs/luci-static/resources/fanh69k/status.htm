<%+header%>
<div class="cbi-map">
    <h2 name="content"><%:Real-time Fan Status%></h2>
    <div class="cbi-section">
        <div class="cbi-value">
            <label class="cbi-value-title"><%:Temperature%></label>
            <div class="cbi-value-field" id="current_temp">-</div>
        </div>
        <div class="cbi-value">
            <label class="cbi-value-title"><%:Current PWM%></label>
            <div class="cbi-value-field" id="current_pwm">-</div>
        </div>
        <div class="cbi-value">
            <label class="cbi-value-title"><%:Allowed Range%></label>
            <div class="cbi-value-field" id="allowed_range">
                PWM: <span id="min_pwm">-</span>-<span id="max_pwm">-</span> | 
                Temp: <span id="min_temp">-</span>℃-<span id="max_temp">-</span>℃
            </div>
        </div>
    </div>
</div>

<script>
setInterval(function() {
    fetch('<%=luci.dispatcher.build_url("admin", "system", "fanh69k", "status")%>')
        .then(res => res.json())
        .then(data => {
            document.getElementById("current_temp").textContent = data.temp + " ℃";
            document.getElementById("current_pwm").textContent = data.pwm;
            document.getElementById("min_pwm").textContent = data.min_pwm;
            document.getElementById("max_pwm").textContent = data.max_pwm;
            document.getElementById("min_temp").textContent = data.min_temp;
            document.getElementById("max_temp").textContent = data.max_temp;
        });
}, 2000);
</script>
<%+footer%>
