include $(TOPDIR)/rules.mk

PKG_NAME:=fan-control
PKG_VERSION:=1.3
PKG_RELEASE:=1

PKG_MAINTAINER:=Your Name <your.email@example.com>
PKG_LICENSE:=MIT

include $(INCLUDE_DIR)/package.mk

define Package/fan-control
  SECTION:=utils
  CATEGORY:=Utilities
  TITLE:=Intelligent Fan Control System
  DEPENDS:=+lua +luci +luci-base
  PKGARCH:=all
endef

define Package/fan-control/description
  Advanced fan control system with temperature monitoring,
  PWM control and LuCI web interface support.
endef

define Build/Configure
endef

define Build/Compile
endef

define Package/fan-control/install
    # 安装配置文件
    $(INSTALL_DIR) $(1)/etc/config
    $(INSTALL_CONF) ./files/etc/config/fanctl $(1)/etc/config/
    
    # 安装初始化脚本
    $(INSTALL_DIR) $(1)/etc/init.d
    $(INSTALL_BIN) ./files/etc/init.d/fanctl $(1)/etc/init.d/
    $(INSTALL_BIN) ./files/etc/init.d/fanctl-init $(1)/etc/init.d/
    
    # 安装LuCI控制器
    $(INSTALL_DIR) $(1)/usr/lib/lua/luci/controller
    $(INSTALL_DATA) ./files/usr/lib/lua/luci/controller/fanctl.lua $(1)/usr/lib/lua/luci/controller/
    
    # 安装CBI模型
    $(INSTALL_DIR) $(1)/usr/lib/lua/luci/model/cbi
    $(INSTALL_DATA) ./files/usr/lib/lua/luci/model/cbi/fanctl.lua $(1)/usr/lib/lua/luci/model/cbi/
    
    # 安装视图模板
    $(INSTALL_DIR) $(1)/usr/lib/lua/luci/view/fanctl
    $(INSTALL_DATA) ./files/usr/lib/lua/luci/view/fanctl/status.htm $(1)/usr/lib/lua/luci/view/fanctl/
    
    # 安装语言文件
    $(INSTALL_DIR) $(1)/usr/lib/lua/luci/i18n
    $(INSTALL_DATA) ./po/zh_Hans/fanctl.po $(1)/usr/lib/lua/luci/i18n/fanctl.zh-cn.po
endef

$(eval $(call BuildPackage,fan-control))
